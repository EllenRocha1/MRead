<div class="container py-5" data-controller="search-books">
  <div class="row justify-content-center">
    <div class="col-md-8">
      
      <h2 class="main-heading">Adicionar Novo Livro</h2>

      <div class="search-box p-4 rounded mb-4 shadow" style="background-color: var(--bg-secondary); border: 1px solid var(--accent-coffee);">
        
        <%# Form de fachada: 'url: "#"' impede submissões acidentais que mudam a página %>
        <%= form_with url: "#", method: :get, data: { action: "submit->search-books#prevent" } do |f| %>
          <label class="form-label mb-2" style="color: var(--accent-brass);">Pesquisar na Open Library</label>
          
          <div class="input-group">
            <%= f.text_field :query, 
                             class: "form-control bg-dark text-light border-brass", 
                             placeholder: "Digite o título para buscar...", 
                             data: { 
                               search_books_target: "input",
                               action: "keyup->search-books#search" 
                             } %>
            
            <button type="button" class="btn btn-brass" data-action="click->search-books#search">
              <i class="bi bi-search"></i> Pesquisar
            </button>
          </div>

          <%# Feedback visual: O Spinner Dourado (JS Exibição) %>
          <div data-search-books-target="loading" class="text-center mt-3 d-none">
            <div class="spinner-border" style="color: var(--accent-brass);" role="status"></div>
            <p class="small mt-2" style="color: var(--accent-brass);">Consultando pergaminhos digitais...</p>
          </div>
        <% end %>
      </div>

      <hr class="border-brass opacity-25">

      <%# O container onde o JavaScript injetará os resultados via Turbo Frame %>
      <div data-search-books-target="results">
        <%= turbo_frame_tag "results_frame", 
                             data: { action: "turbo:frame-load->search-books#hideLoading" } do %>
           <div class="search-placeholder" id="results-placeholder">
             <p>Os resultados da Open Library aparecerão aqui após a busca.</p>
           </div>
        <% end %>
      </div>

      <div class="mt-4 text-center">
        <%= link_to books_path, class: "btn-link text-decoration-none", style: "color: var(--accent-brass);" do %>
          <i class="bi bi-arrow-left"></i> Voltar para minha estante
        <% end %>
      </div>

    </div>
  </div>
</div>